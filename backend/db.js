const { neon } = require("@neondatabase/serverless");

const sql = neon(process.env.DATABASE_URL);

const addMovies = async function () {
  movieId = [
    1184918, 519182, 959604, 533535, 1040159, 1245165, 912649, 1414048, 1284120,
    1045938, 50433, 1276073, 1471014, 1165642, 335984, 1092899, 1022789,
    1356236, 1011985, 21316, 954, 299536, 811941, 1087192, 933260, 1252309,
    696506, 558449, 541671, 823219, 24428, 1156593, 9358, 539972, 297762,
    870028, 238, 15567, 927342, 793387, 793387, 9286, 1244890, 19912, 38575,
    1244944, 353081, 259872, 37799, 1260820, 1137350, 1321017, 872585, 969778,
    671, 1128505, 1064213, 1064486, 1294203, 10191, 1160956, 1377424, 1313194,
    1244944, 974573, 1020414, 10191, 597, 1391483, 914, 1180763, 1104845,
    1212855, 411, 1405338, 302946, 945961, 829557, 1323784, 592695, 592695,
    1356039, 278, 299534, 1084199, 634649, 778578, 1147416, 138843, 1249213,
    845781, 1234821, 1125899, 385687, 1433371, 1118031, 967160, 502356, 1016126,
    573435, 1482554, 808, 1249289, 56292, 1422211, 361743, 603692, 1229730,
    1078600, 14836, 975755, 569094, 1083968, 1251621, 693134, 496243, 1373723,
    1297763, 11, 402431, 141052, 346698, 550, 198663, 1457515, 453395, 995926,
    18785, 462183, 155, 324786, 1035048, 1465476, 1151039, 27205, 615457,
    1087891, 603, 974576, 1092506, 372058, 345940, 823464, 315162, 177677, 279,
    672, 842328, 315635, 2108, 39843, 1034541, 1100782, 458220, 788929, 414906,
    269149, 1310086, 283995, 673, 1337395, 956, 216015, 263115, 82702, 774370,
    106646, 1097549, 955, 76600, 346672, 384018, 1470086, 98, 438631, 1165067,
    218, 8966, 1353117, 48650, 748783, 700391, 19995, 537915, 1195430, 120,
    1442532, 1357633, 862, 980477, 419430, 339967, 13, 447332, 993710, 38365,
    678512, 557, 1388366, 298618, 674, 129, 807, 423108, 1195585, 1226406,
    1217690, 181808, 38757, 354912, 757725, 458156, 22, 429617, 346685, 866398,
    1233575, 321612, 244786, 1101401, 698687, 281338, 431609, 786892, 375834,
    8587, 675353, 102651, 926670, 812455, 343674, 293660, 250546, 839033, 585,
    82023, 424, 370172, 667538, 1189423, 1189423, 122, 27449, 181812, 1585,
    1390394, 109445, 146233, 1307520, 259693, 507086, 970450, 497, 653346,
    1061474, 1138194, 863, 675, 1241752, 2062, 2062, 122917, 1060046, 337404,
    940551, 335, 549590, 767, 396535, 1018247, 1495, 106, 1217379, 568124,
    801335, 420818, 1029235, 1029575, 650033, 150540, 150540, 744, 436969,
    1059073, 150689, 639720, 640, 1726, 228150, 429200, 12445, 846433, 1885,
    1181107, 135397, 957119, 389, 843527, 292610, 383498, 99861, 931349,
    1208808, 170, 177572, 12, 296096, 11036, 792, 447365, 1261050, 58, 1005331,
    707610, 426063, 617126, 1235431, 210577, 19, 911430, 425, 809, 588228,
    37165, 1255788, 290098, 572802, 324857, 929590, 313369, 1111867, 968051,
    284054, 1092, 680, 1100988, 585032, 11324, 1038392, 921436, 976573, 1138749,
    985939, 1410082, 337167, 402, 9502, 335983, 1865, 12444, 1064028, 1196470,
    110415, 505642, 36557, 209112, 549509, 329865, 413846, 156022, 857, 111,
    516729, 330459, 71689, 9849, 475557, 868759, 1302916, 439079, 979275, 8681,
    1461678, 166428, 1029281, 974453, 85430, 10625, 1022796, 1077782, 271110,
    1278162, 175168, 4348, 1043905, 521029, 50270, 1124, 324552, 957452, 240832,
    333339, 315837, 346364, 454626, 257094, 652, 1327766, 311324, 787699,
    818647, 423204, 359410, 1136721, 480530, 489, 670292, 50620, 16869, 1022787,
    637649, 566525, 840705, 1100099, 1111873, 587727, 545611, 762441, 4011,
    72190, 4011, 72190, 4232, 140607, 204082, 293167, 559, 1143407, 285, 670,
    1055451, 14160, 799583, 895956, 41264, 4935, 121, 284052, 1201176, 447277,
    333371, 353491, 777443, 476669, 76341, 564, 337401, 36647, 615173, 118, 240,
    1930, 49026, 343668, 21542, 1072790, 39876, 829560, 10138, 1051896, 1093237,
    746036, 10867, 449443, 507089, 508943, 1125510, 710295, 926393, 10681,
    615656, 370663, 718821, 1153194, 4247, 12153, 953, 2109, 424694, 508442,
    1084736, 949, 929204, 73723, 350, 1312833, 4951, 1407861, 1062276, 940721,
    508883, 68718, 1607, 9820, 960139, 546554, 718930, 131631, 10674, 464052,
    1217876, 101, 937287, 395834, 6977, 766507, 351286, 50619, 882598, 274336,
    126889, 792307, 1034391, 645710, 529203, 349167, 616037, 17473, 791373,
    77338, 436270, 62177, 49051, 1103432, 365177, 508947, 286687, 950784,
    1254786, 493922, 9806, 474350, 1114513, 284053, 1145608, 8392, 1357359,
    604685, 753342, 578, 78, 561, 420817, 635302, 882569, 851644, 1895, 1311031,
    787, 1135869, 625976, 585511, 1333100, 140300, 619979, 694, 1301650,
    1147710, 917496, 320288, 320288, 974262, 408, 39254, 1402, 168259, 585083,
    591273, 49519, 1477884, 335988, 810, 152601, 281957, 348350, 1147400, 1579,
    695721, 172768, 1096197, 1304594, 1003596, 466272, 460458, 581528, 514593,
    214756, 854, 915935, 930094, 2493, 49530, 10020, 1296500, 1445276, 947891,
    438695, 1357459, 1096838, 996821, 1079091, 10192, 122906, 75656, 1008042,
    109418, 310307, 951491, 770156, 1091, 1282980, 1249385, 545609, 1291559,
    1265827, 186982, 22832, 68721, 420809, 141, 923667, 3933, 135348, 10144, 85,
    1893, 49013, 166426, 980489, 14161, 629542, 920, 1442538, 1127166, 855,
    1001274, 527774, 613504, 10198, 726139, 2105, 466420, 1106739, 10195, 22705,
    19173, 68726, 755679, 293670, 396422, 1321952, 889737, 760104, 634492,
    300668, 341013, 1265, 11224, 345, 1352774, 377, 496450, 257344, 1724,
    974950, 1013601, 27578, 176, 91314, 242582, 47971, 1466938, 372049, 763215,
    1232449, 580489, 20352, 399170, 45243, 1140233, 1140233, 128, 38, 838209,
    280, 96721, 297802, 6479, 530385, 512200, 1146927, 9487, 661539, 348893,
    1333099, 1000837, 429, 588648, 713704, 8363, 29882, 9655, 1292868, 405774,
    1114894, 427641, 38700, 1084242, 406997, 969492, 679, 137113, 536554, 10591,
    103, 1014505, 582825, 1329336, 353486, 423, 423, 979, 591274, 37135,
    1129598, 615777, 77, 50014, 2323, 490132, 1235623, 607, 812, 19994, 1261125,
    1411773, 1310861, 646385, 1081012, 162, 9552, 1242669, 49521, 420634, 98566,
    338953, 524047, 72105, 299054, 1023922, 207703, 18, 46195, 133521, 61979,
    335797, 38199, 12155, 102382, 398818, 438148, 9902, 76492, 1422, 1469239,
    974635, 76338, 493529, 1013850, 10193, 884605, 1226578, 8835, 556694,
    1371727, 744276, 1412113, 24021, 507241, 197, 207, 7512, 800158, 602,
    260514, 24, 1104844, 697843, 213, 57158, 50546, 524434, 1949, 1294947,
    550988, 1339772, 88941, 512195, 609681, 473, 473, 87101, 50839, 257211, 289,
    579974, 206487, 810693, 44896, 745, 395992, 335977, 567609, 1014590, 89,
    49046, 624860, 19913, 1116490, 65754, 621, 308509, 976734, 206647, 337339,
    1562, 1136867, 483456, 1272149, 615453, 73861, 1055871, 640146, 944401,
    301528, 1354627, 666277, 359724, 43949, 274855, 274855, 1359, 10184, 978796,
    286217, 43347, 577922, 901362, 453, 9757, 9470, 1262983, 893723, 630586,
    120467, 9737, 1222064, 330457, 395990, 637, 948549, 288986, 275, 60898,
    13475, 974931, 381284, 18239, 190859, 378064, 539, 1122099, 4108, 10830,
    1188104, 592983, 273481, 1366, 604, 594, 1086548, 820525, 1182387, 1140847,
    1079485, 520763, 916224, 967847, 49444, 1059128, 93456, 305470, 495979,
    641284, 972533, 1771, 80321, 398978, 1075794, 870360, 9880, 3170, 1128650,
    397243, 1417, 87, 1244492, 82690, 64682, 930564, 9769, 27, 1483614, 524,
    399579, 1894, 1029880, 107, 249578, 8355, 715931, 371645, 62211, 565, 329,
    1016121, 9479, 801688, 62, 934433, 1173558, 16814, 454983, 242, 482321,
    1201012, 516486, 30497, 1071585, 530254, 1164355, 4248, 11970, 271718, 9291,
    719221, 1001311, 9323, 44833, 686, 86331, 451915, 1049171, 1227128, 2666,
    306, 272, 14574, 1151470, 157350, 338952, 458897, 249397, 1175942, 961268,
    1077328, 615, 16048, 379149, 1048241, 64690, 127585, 390845, 1139566,
    877817, 1155281, 717196, 515001, 341174, 131634, 131634, 194, 161, 205596,
    75780, 1230208, 259316, 381288, 1319738, 339846, 9023, 638507, 101299,
    594767, 114, 1124641, 260513, 32657, 562, 235, 938614, 319, 325358, 18240,
    7345, 9603, 1317088, 6477, 601, 9919, 1734, 1318856, 301502, 1127227,
    799766, 7485, 576784, 772, 1271, 676, 74, 1244361, 1374, 527641, 1395724,
    339403, 9509, 343611, 770, 22970, 437342, 1891, 601796, 760497, 484247,
    260346, 334541, 44214, 70160, 1229646, 1229646, 603661, 949423, 1100856,
    277217, 467244, 788, 425909, 955555, 937278, 1056108, 1301632, 7131, 62835,
    5175, 1278, 850165, 593643, 791042, 308266, 5174, 516632, 1032823, 338947,
    1329643, 253350, 1028196, 84892, 773543, 5879, 1299652, 877703, 28, 35,
    522627, 7446, 294254, 840430, 1103621, 312221, 1701, 611698, 11836, 270303,
    1160018, 1813, 4922, 246655, 153104, 1280672, 57800, 614930, 616446, 9340,
    600, 620, 220289, 16859, 1145725, 587792, 587792, 509, 831815, 53182, 17422,
    7555, 1239655, 70981, 1086747, 331482, 510, 440021, 530915, 10545, 8856,
    756999, 95, 13186, 1022690, 300671, 1390681, 535292, 118340, 995803, 39513,
    11423, 739405, 71552, 2005, 481871, 1470082, 6844, 76203, 758323, 1144962,
    781732, 11770, 11845, 335787, 531428, 531428, 1041613, 37724, 916192,
    324668, 591, 629, 19404, 950, 76757, 843, 198184, 1250, 744275, 1302004,
    9928, 23823, 254, 197158, 105825, 9738, 34851, 826510, 9732, 1241320,
    657893, 1924, 72559, 10377, 698508, 263472, 2322, 900667, 1368, 725201,
    883954, 976893, 71672, 270946, 1109255, 8358, 8920, 848538, 1216191,
    1063877, 491418, 848326, 123338, 4256, 1261148, 677179, 9325, 149, 180,
    565770, 406563, 125509, 605, 49018, 491480, 491480, 1892, 13183, 1059064,
    508642, 314, 598, 1100287, 297270, 57214, 4523, 965150, 109439, 87827, 440,
    73, 1202479, 11969, 66075, 451048, 630, 64688, 459151, 1457124, 417859,
    505706, 762975, 38055, 8689, 619264, 198038, 26389, 1933, 76617, 450465,
    479455, 948, 2251, 616, 20526, 20526, 65, 522938, 50646, 1037113, 970347,
    1071215, 752623, 84308, 340666, 801604, 8961, 545364, 1134754, 500, 424783,
    399566, 8467, 10882, 254128, 400535, 282035, 402900, 639933, 857598,
    1167366, 81188, 346648, 51482, 1000075, 102899, 364, 318846, 762504, 519465,
    568160, 1094974, 804150, 8909, 412117, 675445, 116745, 853, 136799, 4909,
    9444, 119450, 387824, 840326, 792293, 4347, 186622, 1082195, 984324, 842675,
    8413, 1252428, 9072, 1339206, 988078, 9072, 1339206, 988078, 499191, 967,
    666950, 9693, 1427, 121856, 51876, 76493, 336843, 13051, 989662, 1050035,
    194662, 1167271, 458723, 333669, 856289, 12519, 9741, 433808, 393, 913290,
    34433, 861, 1196943, 5548, 500664, 2048, 14, 999613, 264660, 59440, 274870,
    18823, 54138, 614933, 4977, 82675, 1018, 673593, 12092, 871, 105864, 964980,
    9339, 6637, 158852, 137106, 138832, 15255, 497582, 9802, 2758, 9257, 619803,
    115290, 955916, 142, 1094138, 340837, 583553, 13179, 10527, 2330, 1026436,
    765897, 14869, 10588, 2649, 116149, 614479, 440471, 334533, 752, 1259024,
    310131, 814889, 814889, 9637, 1075676, 9837, 60308, 88, 1204892, 196867,
    4257, 1203329, 932086, 46738, 724495, 682507, 8204, 933131, 435, 388, 58574,
    696806, 1010818, 373571, 1087822, 27581, 1239251, 68724, 4564, 8456, 466282,
    124905, 14324, 799379, 11631, 278924, 50544, 268, 75612, 591275, 664413,
    4982, 1055110, 9360, 310, 12560, 927, 406990, 957, 849509, 643215, 334543,
    8839, 534, 10528, 610150, 10607, 1365103, 5559, 1059372, 81, 165, 165, 217,
    26466, 277216, 346910, 1593, 1438208, 1057491, 404368, 1235499, 1088514,
    333484, 9398, 232672, 522212, 664, 847, 726759, 1062215, 75258, 646389,
    460019, 796, 273248, 1104271, 1052243, 276907, 784524, 9602, 316029, 921636,
    296, 704239, 23168, 9016, 291805, 1221404, 50268, 345887, 581726, 345887,
    581726, 283366, 1262725, 278927, 246196, 1020951, 146, 9374, 1061990,
    776797, 379686, 628, 49047, 293863, 793058, 567811, 256522, 872906, 400155,
    228165, 646097, 9373, 1285965, 363088, 7445, 19959, 12429, 339692, 83533,
    1012201, 9352, 45612, 560016, 258947, 3597, 4258, 82695, 10009, 400160, 76,
    505026, 251, 187, 298382, 9476, 614934, 390043, 1221451, 934632, 297761,
    1163258, 879, 71676, 592831, 869, 19908, 1008953, 264980, 608, 184345, 644,
    8055, 1331375, 526896, 290859, 290595, 828613, 82507, 1101448, 558, 10634,
    173705, 988402, 467407, 185652, 522402, 364689, 856, 93685, 987686, 1052280,
    392044, 754, 176627, 959098, 339964, 762430, 36055, 1440718, 9654, 610219,
    375846, 1264854, 175112, 329505, 627725, 774825, 5925, 1225377, 9792, 881,
    311, 812225, 10515, 36670, 400106, 391, 841, 77950, 1382406, 7518, 762,
    81005, 37958, 63, 8922, 169917, 858017, 10555, 80852, 68735, 1824, 308531,
    8065, 9342, 11013, 169, 1359227, 8273, 559969, 936108, 342473, 1186532,
    459003, 1620, 615677, 501929, 317442, 80278, 80278, 1369, 10229, 2024, 8871,
    9353, 1014214, 827931, 936621, 61791, 400928, 1215162, 1026999, 514847,
    455476, 11212, 1086497, 705996, 20453, 1276945, 646380, 1042834, 9426, 2454,
    1417313, 2059, 11362, 1020006, 34544, 460465, 1305194, 4478, 645757, 1954,
    47933, 818397, 280180, 346, 1078605, 585268, 661374, 274857, 570670, 27582,
    5915, 360920, 5876, 11351, 22683, 187017, 2164, 79379, 658224, 10386,
    1094274, 399055, 7220, 1380682, 9659, 912916, 1293263, 1075515, 20763,
    1003598, 795514, 7980, 269955, 86834, 484641, 1214509, 249070, 619730, 9982,
    265208, 8488, 452832, 4233, 112355, 10693, 11360, 713364, 185, 1278263,
    504253, 73456, 10315, 533444, 495764, 1062807, 41513, 1247019, 896151, 9739,
    747, 132232, 188222, 1148677, 1372, 1538, 5503, 1222248, 2907, 1151949,
    345938, 587807, 254320, 11220, 1214667, 20982, 590223, 690957, 1045021,
    49049, 838240, 376867, 1051891, 97630, 287947, 1010600, 228967, 1059643,
    8277, 76726, 6957, 380, 924, 37136, 11824, 747188, 611381, 13053, 897087,
    138103, 152, 1040148, 537996, 1927, 1102493, 106164, 629176, 660982, 4638,
    10483, 21208, 989730, 446696, 850920, 544401, 39323, 87428, 547016, 55721,
    484133, 972614, 779782, 1139817, 47626, 278154, 262500, 706503, 503919,
    9475, 57165, 76163, 1637, 14784, 138446, 72545, 974250, 568, 10895, 1076291,
    1010335, 4148, 8275, 966220, 153, 14926, 1255020, 159045, 1255020, 159045,
    726209, 480414, 1267, 1088257, 10494, 406759, 55580, 6114, 882059, 499701,
    784651, 1075334, 1210938, 446893, 655, 1903, 33, 7443, 37797, 38234, 58008,
    49797, 115, 546121, 710, 11518, 813, 1127767, 1371202, 942576, 563, 5492,
    667520, 1216385, 1008409, 10585, 617882, 9392, 9392, 1979, 277, 9335,
    351523, 22803, 41154, 17654, 446354, 632727, 531219, 11619, 83542, 646683,
    445571, 114350, 1066262, 538858, 415, 1226572, 360814, 966, 324852, 1089,
    14564, 253935, 1141581, 1061699, 167830, 147441, 458305, 1541, 87502,
    487297, 1130053, 196, 832964, 22881, 1171640, 51739, 2270, 1083241, 82693,
    705, 223702, 421928, 180299, 11104, 784941, 215, 10734, 8848, 49040,
    1190462, 919207, 7191, 399905, 1068452, 332210, 228161, 228161, 984, 11281,
    428078, 411088, 941, 3021, 70, 1209290, 298, 865463, 425274, 9362, 568620,
    798021, 324558, 13223, 85877, 321258, 653349, 9567, 287649, 46342, 1084812,
    462, 49529, 4234, 10140, 627, 21724, 740985, 423502, 66245, 2770, 787752,
    1114967, 22794, 18491, 14411, 508439,
  ];
  const options = {
    method: "GET",
    headers: {
      accept: "application/json",
      Authorization: `Bearer ${process.env.TMDB_ACCESS_TOKEN}`,
    },
  };
  for (const id of movieId) {
    try {
      const response = await fetch(
        `https://api.themoviedb.org/3/movie/${id}`,
        options
      );
      const data = await response.json();
      if (!response.ok) {
        console.log(data);
        continue;
      }
      const result =
        await sql`INSERT INTO movies(id,title,poster,backdrop,overview,released,runtime,tagline,rating)
        VALUES (${id}, ${data.title}, ${process.env.TMDB_IMAGE_URL} || ${data.poster_path}, ${process.env.TMDB_IMAGE_URL} || ${data.backdrop_path}, ${data.overview}, ${data.release_date}, ${data.runtime}, ${data.tagline}, ${data.vote_average})`;
      console.log(result);
      genres.push({ movie: id, genre: data.genres });
    } catch (err) {
      console.error(`Failed: `, err);
    }
  }
  return genres;
};

module.exports = { sql, addMovies };
